{"to":"chris.kirk@slate.com","subject":"Re: Slate Quiz leaderboard question","in_reply_to":"3EF38B2C-4196-43F4-A453-36E178F386EE@slate.com","body":"<br><blockquote type=\"cite\"><div>On Feb. 06, at 05:56 PM, Chris Kirk wrote:</div>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\">Oh, gotcha. We'll show the leaderboard to all users, but only include S+ members on it.<div class=\"\"><br class=\"\"></div><div class=\"\">As far as I understand, we'll need the new endpoint whether or not we use avatars — to ensure the wapo ids are real Slate Plus members and to fetch real display names. From my standpoint, including avatars doesn't add much complexity, so let's exclude them only if they would make it harder to build the endpoint.</div><div class=\"\"><br class=\"\"></div><div class=\"\"><div class=\"\"><div><blockquote type=\"cite\" class=\"\"><div class=\"\">On Feb 6, 2015, at 5:47 PM, Stern, David &lt;<a href=\"mailto:david.stern@slate.com\" class=\"\">david.stern@slate.com</a>&gt; wrote:</div><br class=\"Apple-interchange-newline\"><div class=\"\">\n\n\n\n<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; font-size: 14px; font-family: Calibri, sans-serif;\" class=\"\">\n<div class=\"\">To confirm, I thought we agreed that the leaderboard should only include Slate Plus members BUT should be accessible to EVERYONE…?</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Avatars would be nice, but not absolutely necessary if that makes this significantly more complex.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">David</div>\n<div class=\"\"><br class=\"\">\n</div>\n<span id=\"OLK_SRC_BODY_SECTION\" class=\"\">\n<div style=\"font-family: Calibri; font-size: 11pt; text-align: left; border-width: 1pt medium medium; border-style: solid none none; padding: 3pt 0in 0in; border-top-color: rgb(181, 196, 223);\" class=\"\">\n<span style=\"font-weight:bold\" class=\"\">From: </span>&lt;Kirk&gt;, Chris &lt;<a href=\"mailto:chris.kirk@slate.com\" class=\"\">chris.kirk@slate.com</a>&gt;<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Date: </span>Friday, February 6, 2015 at 5:42 PM<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">To: </span>Doug Harris &lt;<a href=\"mailto:doug.harris@slate.com\" class=\"\">doug.harris@slate.com</a>&gt;<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Cc: </span>\"Nichols, Erin\" &lt;<a href=\"mailto:erin.nichols@slate.com\" class=\"\">erin.nichols@slate.com</a>&gt;, David Stern &lt;<a href=\"mailto:david.stern@slate.com\" class=\"\">david.stern@slate.com</a>&gt;<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Subject: </span>Re: Slate Quiz leaderboard question<br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;\" class=\"\">\n1. David and I agree that the leaderboard should only include Slate Plus members and be accessible only to Slate Plus members.\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div class=\"\">2. Erin and I Slack'ed about this, and here was our conclusion: We need an endpoint to MySlate that would allow the interactives server to fetch the display names and avatar URLs associated with multiple wapo IDs in one request. The current endpoint&nbsp;only\n exposes the data of the current user based on his/her cookies.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">When a Slate Plus user accesses the leaderboard, the server will look up the top-scoring wapo IDs in our database, hit this new endpoint, then deliver display names, avatars, and scores to the client (with regular caching).</div>\n<div class=\"\"><br class=\"\">\n<div class=\"\">\n<blockquote type=\"cite\" class=\"\">\n<div class=\"\">On Feb 6, 2015, at 5:26 PM, Doug Harris &lt;<a href=\"mailto:doug.harris@slate.com\" class=\"\">doug.harris@slate.com</a>&gt; wrote:</div>\n<br class=\"Apple-interchange-newline\">\n<div class=\"\">\n<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; font-size: 14px; font-family: Calibri, sans-serif;\" class=\"\">\n<div class=\"\">\n<div class=\"\">\n<div class=\"\">Yeah, I think that’s what David has in mind (and I’ve added David to this thread)</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Chris – Can you give us some more details of what you’ll build here? This will help us:</div>\n<ul class=\"\">\n<li class=\"\">Validate that it matches what David has in mind (and in tune with feedback he’s gotten from Jacob and others)</li><li class=\"\">Determine what work will be needed from Erin or other dev team people</li></ul>\n<div class=\"\">Thanks,</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Doug</div>\n<div class=\"\">\n<div id=\"MAC_OUTLOOK_SIGNATURE\" class=\"\"></div>\n</div>\n</div>\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<span id=\"OLK_SRC_BODY_SECTION\" class=\"\">\n<div style=\"font-family: Calibri; font-size: 12pt; text-align: left; border-width: 1pt medium medium; border-style: solid none none; padding: 3pt 0in 0in; border-top-color: rgb(181, 196, 223);\" class=\"\">\n<span style=\"font-weight:bold\" class=\"\">From: </span>&lt;Kirk&gt;, Chris<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Date: </span>Friday, February 6, 2015 at 12:28 PM<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">To: </span>Erin Nichols<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Cc: </span>Doug Harris<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Subject: </span>Re: Slate Quiz leaderboard question<br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;\" class=\"\">\nThanks. That makes sense. What if we included only S+ users in the leaderboard? (I think that's what David Stern wants anyway.)\n<div class=\"\">\n<div class=\"\">\n<div class=\"\">\n<div class=\"\">\n<div class=\"\"><br class=\"\">\n<div class=\"\">\n<blockquote type=\"cite\" class=\"\">\n<div class=\"\">On Feb 6, 2015, at 12:19 PM, Nichols, Erin &lt;<a href=\"mailto:erin.nichols@slate.com\" class=\"\">erin.nichols@slate.com</a>&gt; wrote:</div>\n<br class=\"Apple-interchange-newline\">\n<div class=\"\">\n<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; font-size: 12px; font-family: Helvetica, sans-serif;\" class=\"\">\n<div class=\"\">\n<div class=\"\">Chris,</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Got it. We don’t store display names and avatars in any database on our end. (We do have some stored for S+ users only, but this obviously doesn’t cover everyone you need).</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">My guess is that you would need to use the Identity API to get this information, which might not be accessible on the client (javascript) side for security reasons. Specifically, you’d need to send a secure hash generated from the wapo_login_id\n and a salt, which you definitely shouldn’t expose in any client-side code or store in a database.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">We are switching our identity providers in the coming weeks/months, so even if we did decide to build a server-to-server solution for communicating with the Identity API, it would be obsolete very soon.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">It’s definitely not good practice to allow a JSONP get request to change data, so I see where you’re coming from.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Erin</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div id=\"\" class=\"\"></div>\n</div>\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<span id=\"OLK_SRC_BODY_SECTION\" class=\"\">\n<div style=\"font-family: Calibri; font-size: 12pt; text-align: left; border-width: 1pt medium medium; border-style: solid none none; padding: 3pt 0in 0in; border-top-color: rgb(181, 196, 223);\" class=\"\">\n<span style=\"font-weight:bold\" class=\"\">From: </span>&lt;Kirk&gt;, Chris &lt;<a href=\"mailto:chris.kirk@slate.com\" class=\"\">chris.kirk@slate.com</a>&gt;<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Date: </span>Friday, February 6, 2015 at 12:05 PM<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">To: </span>Erin Nichols &lt;<a href=\"mailto:erin.nichols@slate.com\" class=\"\">erin.nichols@slate.com</a>&gt;<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Cc: </span>Doug Harris &lt;<a href=\"mailto:doug.harris@slate.com\" class=\"\">doug.harris@slate.com</a>&gt;<br class=\"\">\n<span style=\"font-weight:bold\" class=\"\">Subject: </span>Re: Slate Quiz leaderboard question<br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div style=\"word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;\" class=\"\">\nThanks for getting back to me. This is for a leaderboard. The idea is to show the display names, avatars, and scores of 50 users, not the current user.\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">I could just collect this data from all users using their cookies when they submit their scores, but then I'd run into the problems I described to Doug below — namely, changes in a users' display names or avatars won't be reflected until they\n complete another quiz, and, secondly, it would be easy to send porn and curse words into this system.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Ideally, clients would only send their wapo_ids during score submissions. Then, when the client requests the leaderboard data, the interactives&nbsp;server&nbsp;would find the wapo_ids with the highest scores in the quiz database, then fetch display names\n and avatars associated with these IDs from a trusted source.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div class=\"\">\n<div class=\"\">\n<blockquote type=\"cite\" class=\"\">\n<div class=\"\">On Feb 6, 2015, at 11:48 AM, Nichols, Erin &lt;<a href=\"mailto:erin.nichols@slate.com\" class=\"\">erin.nichols@slate.com</a>&gt; wrote:</div>\n<br class=\"Apple-interchange-newline\">\n<div class=\"\">\n<div id=\"divtagdefaultwrapper\" style=\"font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-family: Calibri, Arial, Helvetica, sans-serif;\" class=\"\">\n<div style=\"margin-top: 0px; margin-bottom: 0px;\" class=\"\">Chris,<br class=\"\">\n</div>\n<div style=\"margin-top: 0px; margin-bottom: 0px;\" class=\"\"><br class=\"\">\n</div>\n<div style=\"margin-top: 0px; margin-bottom: 0px;\" class=\"\">Why not use the wapo_display cookie?</div>\n<div style=\"margin-top: 0px; margin-bottom: 0px;\" class=\"\"><br class=\"\">\n</div><p style=\"margin-top: 0px; margin-bottom: 0px;\" class=\"\"><span style=\"font-family: Constantia, serif;\" class=\"\"><span style=\"font-family: Consolas, monospace;\" class=\"\"></span></span></p>\n<div class=\"\">$.cookie('wapo_display');<br class=\"\">\n</div>\n<div class=\"\">\"EN|<a href=\"https://fbcdn-profile-a.akamaihd.net/hprofile-ak-prn1/c5.5.65.65/s50x50/526506_626243341386_799132045_t.jpg\" class=\"\">https://fbcdn-profile-a.akamaihd.net/hprofile-ak-prn1/c5.5.65.65/s50x50/526506_626243341386_799132045_t.jpg</a>\"<br class=\"\">\n</div>\n<div style=\"margin-top: 0px; margin-bottom: 0px;\" class=\"\"><span style=\"font-family: Constantia, serif;\" class=\"\"><span style=\"font-family: Consolas, monospace;\" class=\"\"></span></span><br class=\"\">\n</div>\n<div class=\"\">That's my display name and avatar (pipe-delimited).<br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Erin<br class=\"\">\n</div>\n<br class=\"\">\n<br class=\"\">\n<div style=\"color: rgb(33, 33, 33);\" class=\"\">\n<hr tabindex=\"-1\" style=\"display: inline-block; width: 1078px;\" class=\"\">\n<div id=\"divRplyFwdMsg\" dir=\"ltr\" class=\"\"><font face=\"Calibri,sans-serif\" style=\"font-size: 11pt;\" class=\"\"><b class=\"\">From:</b><span class=\"Apple-converted-space\">&nbsp;</span>Doug Harris<br class=\"\">\n<b class=\"\">Sent:</b><span class=\"Apple-converted-space\">&nbsp;</span>Friday, February 06, 2015 10:13 AM<br class=\"\">\n<b class=\"\">To:</b><span class=\"Apple-converted-space\">&nbsp;</span>Kirk, Chris<br class=\"\">\n<b class=\"\">Cc:</b><span class=\"Apple-converted-space\">&nbsp;</span>Nichols, Erin<br class=\"\">\n<b class=\"\">Subject:</b><span class=\"Apple-converted-space\">&nbsp;</span>Re: Slate Quiz leaderboard question</font>\n<div class=\"\">&nbsp;</div>\n</div>\n<div class=\"\">\n<div class=\"\">\n<div class=\"\">Yeah, I think sending only wapo_login_id&nbsp;makes the most sense.</div>\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">However, I don’t recommend accessing the user db directly as we’re migrating from one provider to another over the next couple months.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Generally, pages make javascript calls directly to myslate to get user information. There’s a bit of an API wrapped around that.&nbsp;</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">I’ve cc’d Erin on this. Erin, are there calls Chris could put in his code to pull the display name and avatar for users?</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Thanks,</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Doug</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<span id=\"OLK_SRC_BODY_SECTION\" class=\"\">\n<div style=\"font-family: Calibri; font-size: 12pt; text-align: left; border-width: 1pt medium medium; border-style: solid none none; padding: 3pt 0in 0in; border-top-color: rgb(181, 196, 223);\" class=\"\">\n<span style=\"font-weight: bold;\" class=\"\">From:<span class=\"Apple-converted-space\">&nbsp;</span></span>&lt;Kirk&gt;, Chris<br class=\"\">\n<span style=\"font-weight: bold;\" class=\"\">Date:<span class=\"Apple-converted-space\">&nbsp;</span></span>Thursday, February 5, 2015 at 7:10 PM<br class=\"\">\n<span style=\"font-weight: bold;\" class=\"\">To:<span class=\"Apple-converted-space\">&nbsp;</span></span>Doug Harris<br class=\"\">\n<span style=\"font-weight: bold;\" class=\"\">Subject:<span class=\"Apple-converted-space\">&nbsp;</span></span>Slate Quiz leaderboard question<br class=\"\">\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">\n<div class=\"\" style=\"word-wrap: break-word;\">Hi Doug,\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">For the Friday News Quiz leaderboard, I'm planning on showing users' display names and avatars along with their scores, so I've been mulling over how to go about storing this data best.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">My initial thought: Send wapo_login_id, wapo_display, and slate_avatar cookie values with the score (a JSONP request to our interactives server), then update<i class=\"\">players</i>&nbsp;table in the trivia database (primary key is wapo_login_id) with\n these values (or add the player to it).</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">But here's two problems with this approach:</div>\n<div class=\"\">\n<ul class=\"MailOutline\">\n<li class=\"\">If a user changes his displayName or avatar, those changes won't be reflected across the quiz leaderboards until the user takes another quiz.</li><li class=\"\">Somebody could easily hack this with profanities and porn.</li></ul>\n</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">I'm more worried about that second concern. By this system, somebody could look at the source code, send 50 requests, cover the leaderboard with 50 fake perfect scores, and have all the display names be profanities and all the avatars porn. Not\n ideal.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Is there any way to validate the information that the user sends in with Slate's user database? (I don't know anything about that database.)</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Or, an approach that would take care of both problems: The player sends<span class=\"Apple-converted-space\">&nbsp;</span><i class=\"\">only</i><span class=\"Apple-converted-space\">&nbsp;</span>wapo_login_id, and the server fetches the display names and avatars\n from Slate's user database when sending the leaderboard data to the client (with caching).</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Is that doable? Let me know what you think is best.</div>\n<div class=\"\"><br class=\"\">\n</div>\n<div class=\"\">Chris</div>\n</div>\n</div>\n</span></div>\n</div>\n</div>\n</div>\n</blockquote>\n</div>\n<br class=\"\">\n</div>\n</div>\n</div>\n</div>\n</span></div>\n</div>\n</blockquote>\n</div>\n<br class=\"\">\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</span></div>\n</div>\n</blockquote>\n</div>\n<br class=\"\">\n</div>\n</div>\n</div>\n</div>\n</span>\n</div>\n\n</div></blockquote></div><br class=\"\"></div></div></blockquote>","cc":"\"Stern, David\"&lt;david.stern@slate.com&gt;, \"Doug Harris\"&lt;doug.harris@slate.com&gt;, \"Nichols, Erin\"&lt;erin.nichols@slate.com&gt;"}